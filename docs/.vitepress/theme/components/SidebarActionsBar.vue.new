<template>
  <div class="sidebar-actions-bar">
    <div class="action-buttons">
      <button class="action-button small-button" title="æ–°å»ºæ–‡ä»¶" @click="createNewFile">
        <span class="icon">ğŸ“</span>
      </button>
      <button class="action-button small-button" title="æ–°å»ºæ–‡ä»¶å¤¹" @click="createNewFolder">
        <span class="icon">ğŸ“</span>
      </button>
    </div>
  </div>
</template>

<script setup>
import { inject } from 'vue';

// æ³¨å…¥æœåŠ¡
const sidebarService = inject('sidebarService');

// åˆ›å»ºæ–°æ–‡ä»¶
function createNewFile() {
  document.dispatchEvent(new CustomEvent('webnote:create-file', { 
    detail: { parentPath: 'docs' },
    bubbles: true
  }));
}

// åˆ›å»ºæ–°æ–‡ä»¶å¤¹
function createNewFolder() {
  document.dispatchEvent(new CustomEvent('webnote:create-folder', { 
    detail: { parentPath: 'docs' },
    bubbles: true
  }));
}

// åˆ·æ–°ä¾§è¾¹æ 
async function refreshSidebar() {
  try {
    // è§¦å‘ä¾§è¾¹æ åˆ·æ–°äº‹ä»¶
    document.dispatchEvent(new CustomEvent('webnote:refresh-sidebar'));
    
    // å¦‚æœæœ‰ sidebarServiceï¼Œç›´æ¥è°ƒç”¨
    if (sidebarService && sidebarService.mergeSidebars) {
      await sidebarService.mergeSidebars();
    }
  } catch (error) {
    console.error('åˆ·æ–°ä¾§è¾¹æ å¤±è´¥:', error);
  }
}

// æŠ˜å æ‰€æœ‰èœå•
function collapseAll() {
  document.dispatchEvent(new CustomEvent('webnote:collapse-all'));
}
</script>

<style>
.sidebar-actions-bar {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  padding: 2px 6px;
  border-bottom: 1px solid var(--vp-c-divider);
  background-color: var(--vp-c-bg-soft);
}

.action-buttons {
  display: flex;
  gap: 4px;
}

.action-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border: none;
  background: transparent;
  border-radius: 4px;
  cursor: pointer;
  color: var(--vp-c-text-2);
  transition: all 0.2s;
}

.action-button.small-button {
  width: 24px;
  height: 24px;
  font-size: 12px;
}

.action-button:hover {
  background-color: var(--vp-c-bg-mute);
  color: var(--vp-c-brand);
}

.action-button .icon {
  font-size: 14px;
}

/* å“åº”å¼è°ƒæ•´ */
@media (max-width: 768px) {
  .sidebar-actions-bar {
    padding: 2px 4px;
  }
  
  .action-button.small-button {
    width: 22px;
    height: 22px;
  }
  
  .action-button .icon {
    font-size: 12px;
  }
}
</style>
